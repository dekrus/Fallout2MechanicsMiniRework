Это небольшая переработка некоторых игровых механик Fallout 2 и игр на его основе.
 - Скачать обновление мода можно по ссылке (https://github.com/dekrus/Fallout2MechanicsMiniRework/releases).
 
## Установка
- Распаковать архив в основной каталог игры, так чтобы файлы "F2MechanicsMiniRework.dat" и "F2MechanicsMiniRework.ini" оказались в папке mods. 
- F2MechanicsMiniRework требует sfall (`ddraw.dll`) 5.0.6.2+ он поставляется с модом (или опционально 4.4.2+). Если у вас более новая версия, вам не нужно перезаписывать sfall.dll при распаковке архива. 
- Если файл "mods_order.txt" существует в папке mods, то в него необходимо прописать F2MechanicsMiniRework.dat.
- В `ddraw.ini` установите `AllowUnsafeScripting=` на 1 или 2.
- Отредактируйте `mods/F2MechanicsMiniRework.ini`, чтобы включить, отключить или настроить компоненты по своему усмотрению.

## Совместимость
- Совместим со всеми играми на основе Fallout 2. Совместимость с Nevada, Sonora или Fallout et tu можно включить в `mods/F2MechanicsMiniRework.ini`
- Совместим с "FO2tweaks" и "EcCo 0.9+" (с EcCo не совместим мод на кражи, нужно выключить один из них)
- Для полной работы мода на кражи при установленном моде EcCo для Fallout 2 необходимо скачать файл "gl_pbs_steal.int"  по ссылке(https://drive.google.com/file/d/1Kc9oeojrrPEh-LIEh0DubZBGQfDY99GR/view?usp=sharing).
- Закинуть файл "gl_pbs_steal.int" в ...\Fallout 2\data\scripts  (это отключит встоенный в EcCo мод на кражу, для включения просто удалить файл "gl_pbs_steal.int" из папки scripts)
- Выставить FO2_ECCO=0 в файле `mods/F2MechanicsMiniRework.ini`

- Частичная совместимость включается выставлением FO2_ECCO=1 в файле `mods/F2MechanicsMiniRework.ini`.
- Будет работать возможность красть оружие из рук и промерка минимально навыка кражи чтобы заглянуть в карман цели.

### Альтернативный режим стрельбы
(Требуется выставить "AllowUnsafeScripting = 1 или 2" в ddraw.ini)!!!
Этот модуль добавляет Лазерному, Плазменному и Гаусс оружию альтернативный режим стрельбы.
- Альтернативный режим стрельбы активируется прицельным выстрелом в тело.

Лазерное оружие:
- Лазерное оружие наносит урон от оружия(+перки и критические эффекты) всем существам на линии между стрелком и целью.
- Альтернативный выстрел потребляет (2 + 1 * количество дополнительных целей) заряда батарей в магазине лазерного оружия.
- Максимальное количество дополнительных целей настраивается в .ini файле.
- Альтернативный режим увеличивает пробивание брони (все защиты целей от лазера умножаются на 0.5)
- Шанс попадания и вероятность критического удара рассчитывается отдельно для каждой цели.

Импульсное и ЭМИ-оружие дальнего бояоружие:
- Импульсное и ЭМИ-оружие дальнего боя наносит урон от оружия (+ перки и критические эффекты) по «цепи» основной цели и 2 ближайших существ.
- Максимальное расстояние между целями и максимальное количество дополнительных целей настраиваются в файле «F2MechanicsMiniRework.ini».
- Альтернативный режим стрельбы потребляет 3 единцы заряда оружия.
- Шанс критического попадания рассчитывается отдельно для каждой цели.

Гаусс оружие:
- Гаусс оружие наносит урон от оружия (+ перки и критические эффекты) всем существам на линии выстрела.
- Максимальное количество дополнительных целей зависит от урона атакующего, силы снижения урона за каждую цель(настраивается в ini. файле) и показателей защиты у целей на линии.
- Шанс попадания и вероятность критического удара рассчитывается отдельно для каждой цели.

Плазменное оружие:
- Плазменное оружие наносит урон от оружия (+ перки и критические эффекты) всем существам в радиусе вокруг основной цели.
- Радиус плазменного взрыва настраиваеться в .ini файле.
- Урон зависит от расстояния до главной цели. Чем больше дистанция тем меньше урон. (настраиваеться в .ini файле)
- Альтернативный выстрел потребляет 3 заряда батарей в магазине плазменного оружия.
- Вероятность критического удара рассчитывается отдельно для каждой цели.

Пистолеты и ПП:

- Неэнергетические пистолеты и пистолеты-пулеметы позволяют сделать два одиночных выстрела в тело одной и той же цели за стоимость одного прицельного выстрела.
- Первый выстрел (прицельный выстрел в тело) требует стандартной стоимости ОД, но потребляет на 1 ОД меньше, что позволяет вам сделать второй (неприцельный) выстрел по той же цели за 1 ОД.
- Вероятность попадания вторым выстрелом уменьшена на (15 + Wpn STR req * 3), но не может быть ниже 1/3 от первоначального шанса попадания.
- Использование инвентаря/смена оружия/использование предметов/перемещение/перезарядка/стрельба по другой цели прерывает применение способности.

Дробовики:

- Прицельный выстрел в тело отбрасывает врагов и может сбить их с ног.
- Воздействует на цели ближе, чем 10 гексов / половина максимальной дальности оружия.
- Тяжелые существа, такие как супермутанты/роботы/когти смерти/гигантские скорпионы, отбрасываются на меньшее растояние и с меньшей вероятностью будут сбиты с ног.

### Книги навыков
Этот мод позволяет применять книги навыков на спутников для повышения их навыков, а также позволяет менять количество бонусных очков навыка и количество повышаемых навыков при прочтении книг.
(Совместим с F2, F2 EcCo, F1.5:Resurrection, Nevada, Sonora:Продавец книг в Фениксе, Et_Tu)

- Теперь книги навыков могут примерятся к разумным спутникам, для повышения соответствующих навыков. Бонус от прочтения книг сохраняется при повышении уровня спутника.
- Оригинальную формулу получения бонуса к навыку(и его максимальное значение) от прочтения книги можно как увеличить, так и изменить на фиксированное значение.
- Книги могут повышать до 2х навыков сразу, если прописать новый навык в "books.ini". Все книги стандартные книги и любые прописанные в "books.ini" работают с модом.
- Перк "Понимание" теперь повышает не только количество получаемых очков при чтении, но и максимально доступный уровень навыка для чтения.
- Мод работает и с уникальными книгами (Книга советов Fallout II, Nevada: Книга "Homo Ludens",Пособие по нейрохирургии)

Дополнительные настройки которые можно включить отдельно
- Книги можно читать в слух, навык будет увеличиваться у игрока и тому кому он читат книгу, или же у всей группы сразу в зависимости от выбраной опции.
- Наличие перка "Понимание" у игрока работает и у спутников.
- Можно разрешить читать книги и получать бонус от них неразумным спутникам на подобии собак и браминов.
- Для Fallout: Sonora. Если вы установите «FixedSkillInc» и «FixedSkill2Inc» на 0 или меньше, то прирост навыков будет соответствовать описанию книг (+4/+2).

#ПРИМЕР ИЗМЕНЕНИЯ оригинальной книги «Оружие и боеприпасы», чтобы при чтении она повышала навыки "Лёгкое оружие" и "Тяжёлое оружие"
# Если файл "books.ini" отсутствует в папке с игрой, то его можно скачать от сюда (https://gitflic.ru/project/fakelshub/sfall/blob?file=config_files%2Fbooks.ini) или ещё от куда :)
# Дальше смотрим на пример ниже. Для изменения оригинальных книг "overrideVanilla=" в "books.ini" может быть любым, если установлен мой мод.
# "count" в "books.ini" должен быть равен количеству изменнёных и/или добавленных книг
# В квадратных скобках указать [1] порядковый номер новой/изменнёной книги начиная с числа "1", порядок изменения/добавления книги, значения не имеет.

------- Начало примера---------
[1]
; book item PID («Оружие и боеприпасы» PID = 102, Большая научная книга = 73, Учебник первой помощи = 80, Настольная книга скаута=86,Электроника Дина=76, Химические журналы(только для Ф2 и 1.5) = 237), для других книг придётся гуглить
PID=102
; textID from proto.msg which displayed when reading book(«Оружие и боеприпасы» TextID = 805, Большая научная книга = 802, Учебник первой помощи = 804, Настольная книга скаута=806,Электроника Дина=803, Химические журналы(только для Ф2 и 1.5)=802)
TextID=805
; corresponding skill (номер навыка идёт по порядку сверху вниз начинас с Лёгкого оружия = 0, Тяжёлое оружие = 1, Энергетическоге оружие = 2, заначивая навыком натуралиста = 17)
#Skill=0 будет повышать "Лёгкое оружие" на величину установленную в "FixedSkillInc"
Skill=0
#Skill2 Добовляется только этим модом, и работеает только с ним. 
#Skill2=1 будет повышать "Тяжёлое оружие" на величину установленную в "FixedSkill2Inc"
Skill2=1
------- конец примера---------



### ЯД 
(Требуется выставить SpeedInterfaceCounterAnims = 2" и "AllowUnsafeScripting = 1 или 2" в ddraw.ini)!!!

- Теперь урон от яда могут получать не только игрок но и все существа без иммунитета к яду.
- Урон от яда наносится в конце каждого хода отравленного существа в бою или каждые 5 секунд вне боевого режима.
- Урон от яда зависит от максимального здоровья существа, от уровня накопленного яда и может быть настроен в .ini файле.
- Если яда накопится больше 100 ед. наступает мгновенная смерть. 
- Хвосты радскорпионов можно использовать для нанесения яда на колющее и режущее оружие игрока и компаньонов (со временем яд в хвосте заканчивается).
- Все НПЦ и компаньоны во время боя способны самостоятельно наносить яд на своё оружие, если у них в сумке есть хвосты радскорпиона. ( Шанс применения зависит от интеллекта и навыка натуралист у НПЦ).
- С каждым применением на оружие в активной руке накладывается бафф яда(либо на не активную, если в активной нет подходящего оружия), который стакается до 10 зарядов (отображаются как перки в панели персонажа с указанием названия отравленного оружия), чем больше зарядов тем сильнее отравление, каждая успешная атака с вероятностью 33% может потратить 1 заряд яда с оружия, также заряды постепенно убывают если убрать отравленное оружие из рук(в сумку/ продать/потерять). Метательное оружие: отравляется вся пачка, можно не боятся выкинуть единственный отравленный нож.
- Добавлен перк "Консервация яда" доступный с 6 уровня и требующий науку 50+ либо навык натуралиста выше 70.Перк увеличивает количество максимально наносимого яда на оружие и количество применений ядовитой железы радскорпиона. Уменьшает шанс потерять стаки яда при атаке отравленным оружием и скорость потери стаков яда пока оружие не активно. Добавляет отравление при стрельбе боеприпасами для инъектора.

### Лечение стимулятором
(Требуется выставить SpeedInterfaceCounterAnims = 2" и "AllowUnsafeScripting = 1 или 2" в ddraw.ini)!!!
Заменяет мгновенное лечение стимулятором на постепенное восстановление здоровья.
- Если разогнать "скорость восстановления"(Healing_rate, HR) выше 5, то здоровье начнет постепенно восстанавливаться каждый ход в бою и каждые 5 сек вне боя.
- Стимуляторы мгновенно восстанавливают  2-4 ед. здоровья и на 15 секунд (3 хода в бою) увеличивают скорость восстановления на 20 ед., в конце своего действия снижая скорость восстановления на 30 ед. на 1 игровой час.
- Наличие трейта "Ускоренный метаболизм" увеличивает эффективность лечения и значительно снижает штрафы накладываемые стимулятором и суперстимулятором.
- Количество восстанавливаемого здоровья зависит от максимального здоровья и величины скорости восстановления. (настраивается в .ini)
- Суперстимулятор мгновенно восстанавливает до 60 hp, при этом временно уменьшая  "скорость восстановления" в зависимости от фактически восстановленого hp. Если количество лечения превышает доступную "скорость восстановления", то через минуту СС наносит урон. Урон от последействия СС теперь зависит от количества фактически восстановленного здоровья и доступной на момент его применения "скорости восстановления". (если СС применен к существу без повреждений или с очень высокой "скоростью восстановления" и низкими повреждениями, то урон наносится не будет.)
-Также в файле настроек добавлена возможность включения лечения сломанных конечностей(как игроку, так и НПЦ) при помощи Суперстимулятора, при этом увеличивая штраф к  "скорости восстановления", а следовательно и возможный урон от последействия, и немного снижая количество восстанавливаемых ХП, в зависимости от количества и вида травм. (по умолчанию данная возможность отключена)
-Некоторые монстры имеют пассивную регенерацию (ванаминго/кентавры, можно отключить в ini файле). 
-Регенерация монстров как и лечение от стимулятора может временно снижаться или полностью прекратиться  при получении достаточного количества "ожогов"  от огненного или плазменного оружия. Эти "ожоги" действуют как на игрока, так и на НПЦ. (перк "Пироман" защищает от "ожога" при нанесении урона самому себе(гранаты, молотов) и увеличивает силу снижения регенерации у врагов. Состояние "ожога" проходит со временем.
- Добавлен бонусный перк "Регенерация", который автоматически добавляется игроку, если базовая "скорость восстановления" будет больше 5, позволяющий с шансом, зависящим от "скорости восстановления", исцелять травмы конечностей при тиках лечения, как в бою так и вне боя.

### Лечение Аптечками, сумками доктора и парамедика:
- Использование навыка «Первая помощь» и навыка «Доктор» голыми руками без предметов не изменилось. (не конфликтует с ребалансом «Первой помощи» и  «Доктора» из FO2tweaks). 
- Аптечка и сумка доктора сохранили свои прежние бонусы к навыкам (+20% и +40% для улучшенных версий).
- Убран элемент случайности в количестве использований медицинских инструментов, теперь аптечки и сумка врача имеют индикатор оставшихся материалов. Аптечку можно использовать 5 раз, пока она не истощится, сумку врача 3 раза. Улучшенные версии (фельдшерская сумка и аптечка) можно использовать до 10 раз.
- Убран дневной лимит на использование медицинских инструментов. Количество использований ограничено только остатком в аптечке/сумке доктора.
- Каждое использование медицинских инструментов гарантированно восстанавливает некоторое количество здоровья, начиная от минимально возможного (проваленная проверка навыка) до среднего и максимального значений (успешная проверка навыка).
- Перк "Целитель" добавляет дополнительно 4-10 (2-5 для Follout et tu) здоровья к лечению за уровень способности.
- Исцеление не дает очков XP, но даётся 50 очков опыта за вылеченную конечность.
- Эффективность лечения ограничена 300% для обоих типов медицинских инструментов. 

Аптечки:
- Можно использовать во время боя. Также ими могут пользоваться NPC и компаньоны. (зависит от интеллекта, тяжести травм и навыка первой помощи)
- Применение стоит 2 ОД.
- Эффективность лечения простой аптечки становится равна эффективности оригинального стимулятора (12-20 хп) при  ~80-90% навыке первой помощи. 

Докторский саквояж и сумка парамедика:
- Можно использовать во время боя держа в активной руке и если уровень навыка доктора 50% или выше. Также ими могут пользоваться NPC и компаньоны, если их конечности травмированы. (зависит от интеллекта и навыка Доктора)
- Базовая стоимость 6 ОД. Стоимость снижается по мере роста навыка. ( 5 ОД при 100%, 4 ОД при 150% и так далее до 2 ОД при 250% навыке). 
- Эффективность лечения за ОД/навык выше, чем у аптечек. Количество исцеления также зависит от максимального здоровья и тяжести полученных травм.
- Шанс излечить травму рассчитывается для каждой конечности отдельно и ограничен 100% (80% навыка Доктора + 20% бонуса от саквояжа или 60% навыка + 40% бонуса сумки фельдшера).

### Повреждение конечностей от урона взрывом:
- Полученный урон от гранат (включая плазменные, а для роботов также ЕМП ), гранатомётов и прочего оружие взрывного действия,
если он превышает 10% от текущих! очков здоровья может привести к повреждению рук/ног, поражению глаз.
(Вероятность настраивается в ini файле и зависит также от некоторых показателей S.P.E.C.I.A.L. цели).

### Прицельные промахи:
- Для попадания в глаза и пах теперь необходимо чтобы цель была повернута к атакующему лицом. Попадания прицельным выстрелом по глазам когда цель стоит к атакующему спиной будут всегда превращаться в попадания в голову, тоже самое происходит если цель лежит лицом в пол. Вместо паха выстрелы и удары со спины или "задних" боков будут попадать в тело или в одну из ног. ( У некоторых существ попасть в пах можно только со спины или задних боков - кентавры/собаки/брамины и др.)
- Промахи при прицельных атаках с вероятностью равной "шанс попадания в часть тела / 19" (т.е. максимум 5%) могут превратиться в попадание в соседнюю часть тела. (промах по глазам может стать попаданием в голову)
- Попадания в голову при условии что цель повернута лицом к атакующему могут привести к попаданию в глаза.
- Положение частей тела(и соответственно возможность прицельного попадания в них) меняется в зависимости от анимации цели (лежит лицом в небо/пол, валяется на боку, и.т.д.)
- При промахе есть вероятность попадания в случайную цель на пути пули/метательного оружия. Оригинальная система промахов (когда при промахе со 100% вероятностью задевалось существо стоящее ровно позади цели) осталась на месте, была лишь изменена область в которой выбирается  новая случайная цель и вероятность попасть в неё, но если случайное существо одно и стоит ровно за спиной у изначальной цели, то пуля как всегда попадёт в неё).

#### Прицельные попадания для НПЦ
- Для НПЦ увеличен шанс применения прицельных выстрелов до ~25% от всех одиночных атак.
- Существа мелкого размера (муравьи, богомолы, мелкие скорпионы) имеют больший шанс попасть по ногам и практически не могут попасть в голову. Но если цель лежит на полу, то шанс попадания в голову многократно увеличивается.

### Скрытность:
Убрана случайность из навыка скрытности, теперь зона обнаружения постепенно уменьшается с ростом уровня навыка игрока
и зависит как от значения восприятия врагов, так и других факторов (например общего уровня освещения карты).

#### Обнаружение скрытности: (Желательно переключить графику на DirectX 9 для лучшей производительности, а также выставить "DontTurnOffSneakIfYouRun=1" в ddraw.ini во избежание конфликтов с подсветкой НПЦ на клавишу "Shift")
Цветовая индикация обнаружения скрытности работает для оригинальной и новой механики скрытности.
Пока крадущийся игрок находится в пределах видимости NPC, контур этого NPC будет выделен:
- Красным - Игрок обнаружен.
- Оранжевым - (при включённом моде на навык Кражи)  Игрок обнаружен, но НПЦ не заметит попытку кражи у своего союзника.
- Желтый - Игрок не обнаружен, но будет, если приблизится примерно на 2-3 гекса.
- Зеленый - Игрок не обнаружен, можно безопасно приближаться к NPC.
- Серым - (Туман войны в HRP от Mash отключён) Игрок не обнаружен, так как скрыт от НПЦ стеной или другим объектом блокирующим линию обзора.

### Карманная кража:
(Требуется выставить "AllowUnsafeScripting = 1 или 2" в ddraw.ini)!!!
Оригинальная механика карманной кражи не учитывала восприятие цели, а также вероятность неудачи не зависела от навыка Кражи у игрока и была всегда одинакова как для 85% (а иногда и меньших значений), так и для 300%.
И еще одной неприятной особенностью оригинальной механики карманных краж было начало боя с участием каждого жителя города, когда карманная кража не удалась.
Данный мод создан для увеличения влияния навыка кражи и добавления возможности воровать оружие из рук НПЦ

Основные моменты:
- В случае неудачи кражи вместо начала боя будет воспроизведена одна из "сценок" и наложен временный штраф на продажу, покупку и проверку навыков красноречия в диалогах.
- Штрафы будут постепенно уменьшаться и исчезать, если игрок в течение недели не был пойман на карманной краже в этом городе или не посещал его долгое время.
- Жертвы неудачной кражи или попытки заглянуть в карман будут пару дней помнить, что игрок уже пытался у них украсть, и в следующий раз их реакция будет жестче.

- Расчет вероятности успеха аналогичен исходной формуле с добавлением зависимости от восприятия цели и навыка кражи игрока.
- Если навык кражи развит более 140%, то за каждые 10 очков сверху максимальный шанс успешной кражи увеличивается на 1% (0,1% за 1 очко) до максимума в 99%.
- Когда навык превышает 155 + (текущее восприятие цели х 5) становится возможным воровать оружие и предметы из рук NPC. (уровень минимального навыка настраивается в .ini)
- Чтобы заглянуть в карман цели, вам нужно соответствовать минимальным требованиям к навыку.
- В случае неудачной попытки использовать навык кражи, цель может стать враждебной, наличие перка "Безобидный" значительно снижает этот шанс.
 
Отрицательные Модификаторы, повышающие требования к навыку и снижающие шанс успешной карманной кражи:
- Игрок стоит перед лицом цели.
- Игрок находится перед лицом ближайших союзников цели и виден им.
Отрицательные Модификаторы, уменьшающие шанс успешной карманной кражи:
- Вес и размер предмета (если не взят перк "Карманник")
- Количество предметов, украденных подряд.
 
Положительные Модификаторы, снижающие требования к навыкам и повышающие шанс успешной карманной кражи:
- Режим скрытности. Бонус зависит от уровня навыка скрытности + значительное увеличение бонуса, если цель не видит игрока.
- Условия слабой освещенности (пещеры, подвалы, ночь и т.п.) чем темнее тем проще заглянуть в карман.
  (С поправкой на наличие перка "Ночное видение")
- Цель без сознания/ослеплена (бонус зависит от тяжести состояния).
 
Дополнительно включаемые настройки:
- Первая попытка украсть всегда будет 100%, если вы достигли минимально необходимого навыка кражи. (обходной путь для уменьшения количества сохранений/загрузок)
- Последующие попытки, во избежание злоупотребления опытом за кражу, будут рассчитываться по формуле.
- Усложнение кражи предметов в зависимости от их стоимости, чем дороже, тем сложнее.
- Повышение сложности воровства у торговцев.

### Резать или Колоть:
- Добавлена опция для изменения эффекта при атаке ножом в зависимости от анимации атаки (резать/колоть), работает как у игрока, так и у НПЦ:
Режущая атака ножом:
- Имеет больший шанс попадания, величина бонуса зависит от соотношения ловкости цели и мастерства атакующего, в среднем + 5-10%.
- По слабо бронированным целям режущая атака с большей вероятностью нанесет максимальный урон, а не минимальный.

Колющая атака ножом:
- Лучше пробивает бронированные цели (уменьшается DR и DT) в зависимости от показателей максимального урона ножа и бонусного урона в ближнем бою атакующего.
- Также увеличивает шанс критического удара в 1,5 раза от базового шанса (без учета бонуса от прицельных атак).

### Антикрит
Если включено, предотвращает статусные эффекты (травмы, ослепление, нокаут, мгновенную смерть) при получении/нанесении 0 урона при критическом ударе (у игрока и НПЦ).

### Стелсбой вводит в режим скрытности
Если этот параметр включен, режим скрытности автоматически применяется при использовании заряженного стелсбоя.

### Пересчет статистики (по умолчанию отключен)
При изменении базовой Выносливости (перки, имплантаты, но не препараты) пересчитывается максимальное количество здоровья, полученное с предыдущих уровней, что позволяет начать игру с нечетным значением Выносливости, а в дальнейшем сделать его четным, догоняя прогресс максимального здоровья.

При повышении базового интеллекта (перки, импланты, но не препараты) игроку начисляются очки умений по формуле (количество полученных уровней) * (интеллект - начальный интеллект) * 2.


## Удаление
Удалите оба файла `mods/F2MechanicsMiniRework.*` .
